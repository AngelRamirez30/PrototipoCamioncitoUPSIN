import{F as z,a as v,b as p,c as w,d as R,e as D,f as U,g as T,h as V,i as q,j as G,k as O,l as _,o as S,q as k,s as x,t as b,u as C,v as y,w as E}from"./chunk-IC3QN7B3.js";import{g as L,h as P,i as g,k as M}from"./chunk-4JANN4OQ.js";import"./chunk-N2GNVB23.js";import"./chunk-MF5AIBGI.js";import"./chunk-WXI33M2S.js";import{Bb as h,Nb as s,Va as j,Wa as l,ba as c,ca as d,ma as u,nb as f,sb as n,tb as o,ub as m,zc as N}from"./chunk-BJ35RS3A.js";import{f as I}from"./chunk-CQCHLVVT.js";var H=(()=>{let e=class e{};e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c({type:e,selectors:[["auth-layout-page"]],decls:9,vars:0,consts:[[1,"grid","w-full","gap-3","place-items-center"],[1,"absolute","inset-0","-z-10","h-full","w-full","bg-white","bg-[linear-gradient(to_right,#f0f0f0_1px,transparent_1px),linear-gradient(to_bottom,#f0f0f0_1px,transparent_1px)]","bg-[size:6rem_4rem]"],[1,"mt-5","md:mt-8","w-[min(600px,90%)]"],[1,"flex","flex-col","gap-3","items-center","justify-center","mb-4"],[1,"w-[50%]","rounded-full","p-7","flex","items-center","justify-center","shadow-lg","bg-gradient-to-t","from-indigo-400","to-indigo-100"],["src","../../../../assets/logoCamioncito.png","alt","",1,"w-full","h-fit",2,"filter","drop-shadow(0 3px 7px #00000083)"],[1,"text-lg","font-bold"]],template:function(t,a){t&1&&(n(0,"div",0),m(1,"div",1),n(2,"div",2)(3,"div",3)(4,"div",4),m(5,"img",5),o(),n(6,"h1",6),s(7,"CAMIONCITO UPSIN"),o()(),m(8,"router-outlet"),o()())},dependencies:[L],encapsulation:2});let r=e;return r})();var J=(()=>{let e=class e{constructor(i,t,a,B){this.authService=i,this.router=t,this.snackBar=a,this.fb=B,this.loginForm=this.fb.group({email:["",p.required],password:["",p.required]})}onLogin(){let{email:i,password:t}=this.loginForm.value;i?.trim()&&t?.trim()&&this.authService.login(i,t).then(({user:a})=>{if(a)this.openSnackBar("Inicio de sesi\xF3n exitoso",2500),this.redirigirUsuario(a.uid);else throw new Error("Usuario no encontrado")}).catch(a=>{switch(console.error("Error al iniciar sesi\xF3n:",a),a.code){case"auth/wrong-password":this.openSnackBar("Contrase\xF1a incorrecta",2500);break;case"auth/user-not-found":this.openSnackBar("Usuario no encontrado",2500);break;case"auth/invalid-credential":this.openSnackBar("Credenciales inv\xE1lidas",2500);break;case"auth/invalid-email":this.openSnackBar("Correo inv\xE1lido",2500);break}})}openSnackBar(i,t){this.snackBar.open(i,void 0,{duration:t})}redirigirUsuario(i){this.authService.getRoleUser(i).subscribe(t=>{if(t){let{rol:a}=t;switch(a){case"alumno":this.router.navigateByUrl("/alumnos/home");break;case"chofer":this.router.navigate(["/choferes"]);break}}})}};e.\u0275fac=function(t){return new(t||e)(l(S),l(P),l(x),l(O))},e.\u0275cmp=c({type:e,selectors:[["auth-login-page"]],decls:22,vars:1,consts:[[1,"flex","flex-col","items-center","justify-center","w-full",3,"formGroup"],[1,"flex","gap-4","w-full","items-center"],[1,"mb-4"],[1,"w-full"],["type","email","matInput","","placeholder","Ingrese su email","formControlName","email"],["type","password","matInput","","placeholder","Contrase\xF1a","formControlName","password"],["mat-button","","mat-flat-button","","color","primary",1,"w-1/2","mx-auto",3,"click"],[1,"flex","justify-end","mt-5"],["routerLink","/auth/forget-password",1,"hover:text-indigo-600","transition-all"]],template:function(t,a){t&1&&(n(0,"form",0)(1,"div",1)(2,"mat-icon",2),s(3,"person"),o(),n(4,"mat-form-field",3)(5,"mat-label"),s(6,"Email"),o(),m(7,"input",4),o()(),n(8,"div",1)(9,"mat-icon",2),s(10,"lock"),o(),n(11,"mat-form-field",3)(12,"mat-label"),s(13,"Contrase\xF1a"),o(),m(14,"input",5),o()(),n(15,"button",6),h("click",function(){return a.onLogin()}),n(16,"mat-icon"),s(17,"login"),o(),s(18," Ingresar "),o(),n(19,"div",7)(20,"a",8),s(21,"\xBFOlvidaste tu contrase\xF1a? Recuperala"),o()()()),t&2&&f("formGroup",a.loginForm)},dependencies:[g,k,C,b,y,E,U,v,w,R,V,q]});let r=e;return r})();var K=(()=>{let e=class e{constructor(i,t){this.authService=i,this.snackBar=t,this.email=new D("",[p.required,p.email]),this.sended=!1}onReceiveEmail(){return I(this,null,function*(){let i=this.email.value;try{if(yield this.authService.checkEmailExists(i))try{yield this.authService.resetPassword(i),this.openSnackBar("Email enviado",2500)}catch{this.openSnackBar("Error al enviar el correo",2500)}else this.openSnackBar("Correo no registrado",2500),this.email.reset()}catch(t){switch(console.error("Error al iniciar sesi\xF3n:",t),t.code){case"auth/wrong-password":this.openSnackBar("Contrase\xF1a incorrecta",2500);break;case"auth/user-not-found":this.openSnackBar("Usuario no encontrado",2500);break;case"auth/invalid-credential":this.openSnackBar("Credenciales inv\xE1lidas",2500);break;case"auth/invalid-email":this.openSnackBar("Correo inv\xE1lido",2500);break}}})}openSnackBar(i,t){this.snackBar.open(i,void 0,{duration:t})}};e.\u0275fac=function(t){return new(t||e)(l(S),l(x))},e.\u0275cmp=c({type:e,selectors:[["ng-component"]],decls:15,vars:1,consts:[[1,"flex","flex-col","items-center","justify-center","w-full"],[1,"flex","gap-4","w-full","items-center"],[1,"mb-4"],[1,"w-full"],["type","email","matInput","","placeholder","Ingrese su email","required","Debe ingresar su correo",3,"formControl"],["mat-button","","mat-flat-button","","color","primary",1,"w-1/2","mx-auto",3,"click"],[1,"flex","justify-end","mt-5"],["routerLink","/auth/login",1,"hover:text-indigo-600","transition-all"]],template:function(t,a){t&1&&(n(0,"div",0)(1,"div",1)(2,"mat-icon",2),s(3,"person"),o(),n(4,"mat-form-field",3)(5,"mat-label"),s(6,"Email"),o(),m(7,"input",4),o()(),n(8,"button",5),h("click",function(){return a.onReceiveEmail()}),n(9,"mat-icon"),s(10,"login"),o(),s(11," Recupera tu contrase\xF1a "),o(),n(12,"div",6)(13,"a",7),s(14,"Ingrese a su cuenta"),o()()()),t&2&&(j(7),f("formControl",a.email))},dependencies:[g,k,C,b,y,E,v,w,G,T]});let r=e;return r})();var ie=[{path:"",component:H,children:[{path:"login",component:J},{path:"forget-password",component:K},{path:"**",redirectTo:"login"}]}],Q=(()=>{let e=class e{};e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d({type:e}),e.\u0275inj=u({imports:[M.forChild(ie),M]});let r=e;return r})();var ye=(()=>{let e=class e{};e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d({type:e}),e.\u0275inj=u({imports:[N,Q,z,_]});let r=e;return r})();export{ye as AuthModule};
